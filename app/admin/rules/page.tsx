'use client';import { useEffect, useState } from 'react';export default function RulesPage(){const [jsonText,setJsonText]=useState('');const [saving,setSaving]=useState(false);const [message,setMessage]=useState<string|null>(null);useEffect(()=>{fetch('/api/rules').then(r=>r.json()).then(d=>setJsonText(JSON.stringify(d,null,2)));},[]);const save=async()=>{setSaving(true);setMessage(null);try{const res=await fetch('/api/rules',{method:'POST',headers:{'content-type':'application/json'},body:jsonText});if(!res.ok) throw new Error(await res.text());setMessage('Saved new rule pack. You can recompute scores.')}catch(e:any){setMessage('Error: '+e.message)}finally{setSaving(false)}};const recompute=async()=>{setSaving(true);setMessage(null);try{const res=await fetch('/api/recompute',{method:'POST'});if(!res.ok) throw new Error(await res.text());setMessage('Recomputed scores for all movements.')}catch(e:any){setMessage('Error: '+e.message)}finally{setSaving(false)}};return(<div className='space-y-3'><h1 className='text-xl font-semibold'>Rules (JSON)</h1><textarea className='input font-mono h-[420px]' value={jsonText} onChange={e=>setJsonText(e.target.value)} /><div className='flex gap-2'><button onClick={save} className='btn' disabled={saving}>Save rules</button><button onClick={recompute} className='btn' disabled={saving}>Recompute all</button></div>{message&&<div className='text-sm'>{message}</div>}</div>) }
