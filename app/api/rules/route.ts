import { NextRequest, NextResponse } from 'next/server';import { prisma } from '@/lib/db';import { setRules } from '@/lib/rules';export async function GET(){const pack=await prisma.rulePack.findFirst({where:{active:true},orderBy:{version:'desc'}});if(!pack) return NextResponse.json({}, {status:404});const json=typeof pack.content==='string'?JSON.parse(pack.content as any):(pack.content as any);return NextResponse.json(json)}export async function POST(req:NextRequest){const body=await req.json();if(typeof body!=='object'||body==null) return new NextResponse('Invalid JSON',{status:400});const version=await setRules(body);return NextResponse.json({ok:true,version})}
